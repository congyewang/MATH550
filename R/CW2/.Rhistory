Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
return(c(Rt, Ft))
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
set.seed(60854)
pred_number_ii <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02) {
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
return(c(Rt, Ft))
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
set.seed(60854)
pred_number_ii <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02) {
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
return(c(Rt, Ft))
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
LV <- data.frame(time, group, size)
sapply(seq(1, 103), pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
sapply(seq(1, 103), pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1]
sapply(seq(1, 103), pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[2]
sapply(seq(1, 103), pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1][1]
apply(seq(1, 103), 1ï¼Œ pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1][1]
apply(seq(1, 103), 1, pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1][1]
apply(X = seq(1, 103), MARGIN = 1, FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1][1]
apply(X = seq(1, 103), MARGIN = 1, FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
dim(seq(1, 103))
apply(X = seq(1, 103), MARGIN = 2, FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
apply(X = seq(1, 103), MARGIN = 1, FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
lapply(X = seq(1, 103), MARGIN = 1, FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103][1]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
set.seed(60854)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
set.seed(60854)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
set.seed(60854)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
pred_number_ii <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02) {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
return(c(Rt, Ft))
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
lapply(X = seq(1, 103), FUN = pred_number_ii, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[103]
t <- seq(1, 1000)
det_rabbits <- lapply(t, pred_number_i, Rt = R1, Ft = F1, a = 0.05, b = 0.0001, g = 0.02)
t <- seq(1, 1000)
det_rabbits <- lapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
det_rabbits
t <- seq(1, 1000)
det_rabbits <- lapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)[1,]
t <- seq(1, 1000)
det_rabbits <- lapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02)
det_rabbits[1]
det_rabbits[,1]
det_rabbits[1:length(det_rabbits)]
det_rabbits[1:length(det_rabbits)][1]
det_rabbits[1][1:length(det_rabbits)]
det_rabbits[1:2]
det_rabbits[1:2][1]
det_rabbits[1:2][1][1]
pred_number_i <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
for (i in 1:t) {
Rt_1 <- Rt + a * Rt - b * Rt * Ft
Ft_1 <- Ft + b * Rt * Ft - g * Ft
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
R_1 <- 30
F_1 <- 40
r_i <- pred_number_i(103, R_1, F_1)
print(r_i)
pred_number_ii <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02) {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
return(c(Rt, Ft))
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
lapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "r")
sapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "r")
lapply(t, pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "r")
t <- seq(1, 1000)
det_rabbits <- lapply(X = t, FUN = pred_number_i, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "r")
det_rabbits
r_ii <- pred_number_ii(1, R_1, F_1)
pred_number_ii <- function(t, Rt, Ft, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
pred_number_ii(1, R_1, F_1)
pred_number_ii(1, R_1, F_1, choice = "r")
pred_number_ii(1, R_1, F_1, choice = "f")
seq(1, 1000)
sapply(t, lapply(t, pred_number_i))
sapply(t, lapply(t, pred_number_i), Rt = R_1, Ft = F_1)
sapply(t, pred_number_i, Rt = R_1, Ft = F_1)
t <- seq(1, 1000)
det_rabbits <- rep(0, length(t))
det_rabbits
pred_number_i <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
for (i in 1:t) {
Rt_1 <- Rt + a * Rt - b * Rt * Ft
Ft_1 <- Ft + b * Rt * Ft - g * Ft
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
R_1 <- 30
F_1 <- 40
r_i <- pred_number_i(103)
print(r_i)
pred_number_ii <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
sapply(t, pred_number_i, choice = "r")
t <- seq(1, 1000)
det_rabbits <- rep(0, length(t))
det_foxes <- rep(0, length(t))
sto_rabbits <- rep(0, length(t))
sto_foxes <- rep(0, length(t))
for (i in t) {
det_rabbits[i] <- pred_number_i(i, choice = "r")
det_foxes[i] <- pred_number_i(i, choice = "f")
sto_rabbits[i] <- pred_number_i(i, choice = "r")
sto_foxes[i] <- pred_number_i(i, choice = "f")
}
det_rabbits
R_1 <- 30
F_1 <- 40
pred_number_i <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
for (i in 1:t) {
Rt_1 <- Rt + a * Rt - b * Rt * Ft
Ft_1 <- Ft + b * Rt * Ft - g * Ft
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_i <- pred_number_i(103)
print(r_i)
pred_number_ii <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
pred_number_ii(10, R_1, F_1)
4.623933e-04
t <- seq(1, 103)
det_rabbits <- rep(0, length(t))
det_foxes <- rep(0, length(t))
sto_rabbits <- rep(0, length(t))
sto_foxes <- rep(0, length(t))
for (i in t) {
det_rabbits[i] <- pred_number_i(i, choice = "r")
det_foxes[i] <- pred_number_i(i, choice = "f")
sto_rabbits[i] <- pred_number_i(i, choice = "r")
sto_foxes[i] <- pred_number_i(i, choice = "f")
}
det_rabbits
sapply(t, pred_number_i, choice = "r")
t <- seq(1, 103)
det_rabbits <- sapply(t, pred_number_i, choice = "r")
det_foxes <- sapply(t, pred_number_i, choice = "f")
sto_rabbits <- sapply(t, pred_number_ii, choice = "r")
sto_foxes <- sapply(t, pred_number_ii, choice = "f")
# det_rabbits <- rep(0, length(t))
# det_foxes <- rep(0, length(t))
# sto_rabbits <- rep(0, length(t))
# sto_foxes <- rep(0, length(t))
# for (i in t) {
#
#   det_rabbits[i] <- pred_number_i(i, choice = "r")
#   det_foxes[i] <- pred_number_i(i, choice = "f")
#   sto_rabbits[i] <- pred_number_i(i, choice = "r")
#   sto_foxes[i] <- pred_number_i(i, choice = "f")
#
# }
sto_foxes
sto_foxes
sto_foxes
sto_foxes
sto_foxes
sto_foxes
t <- seq(1, 500)
det_rabbits <- sapply(t, pred_number_i, choice = "r")
det_foxes <- sapply(t, pred_number_i, choice = "f")
sto_rabbits <- sapply(t, pred_number_ii, choice = "r")
sto_foxes <- sapply(t, pred_number_ii, choice = "f")
sto_foxes
t <- seq(1, 1000)
det_rabbits <- sapply(t, pred_number_i, choice = "r")
det_foxes <- sapply(t, pred_number_i, choice = "f")
sto_rabbits <- sapply(t, pred_number_ii, choice = "r")
sto_foxes <- sapply(t, pred_number_ii, choice = "f")
sto_foxes
rep("det_rabbits", length(t))
rep("det_rabbits", length(t)) + rep("det_foxes", length(t))
c(rep("det_rabbits", length(t)),  rep("det_foxes", length(t)))
c(rep("det_rabbits", length(t)),  rep("det_foxes", length(t)))[1050]
rep(t, 4)
rep(t, 4)[1001]
# Import Packages
library(tidyverse)
R_1 <- 30
F_1 <- 40
pred_number_i <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
for (i in 1:t) {
Rt_1 <- Rt + a * Rt - b * Rt * Ft
Ft_1 <- Ft + b * Rt * Ft - g * Ft
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_i <- pred_number_i(103)
print(r_i)
pred_number_ii <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t, pred_number_i, choice = "r")
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- c(rep("det_rabbits", length(t_iii)),  rep("det_foxes", length(t_iii)), rep("sto_rabbits", length(t_iii)), rep("sto_foxes", length(t_iii)))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
LV
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- factor(c(rep("det_rabbits", length(t_iii)),  rep("det_foxes", length(t_iii)), rep("sto_rabbits", length(t_iii)), rep("sto_foxes", length(t_iii))))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
LV
p <- ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
p
# Creat DataFrame
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- factor(c(rep("det_rabbits", length(t_iii)),  rep("det_foxes", length(t_iii)), rep("sto_rabbits", length(t_iii)), rep("sto_foxes", length(t_iii))))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
# Plot
p <- ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
# Creat DataFrame
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- factor(c(rep("det_rabbits", length(t_iii)),  rep("det_foxes", length(t_iii)), rep("sto_rabbits", length(t_iii)), rep("sto_foxes", length(t_iii))))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
# Plot
p <- ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
p
# Import Packages
library(tidyverse)
library(ggplot2)
# Creat DataFrame
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- factor(c(rep("det_rabbits", length(t_iii)),  rep("det_foxes", length(t_iii)), rep("sto_rabbits", length(t_iii)), rep("sto_foxes", length(t_iii))))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
# Plot
p <- ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
p
# Plot
p <- ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
p
# Plot
p <- ggplot2::ggplot(LV, aes(x = time, y = size, group = group, color = group)) +
geom_line()
p
# Plot
p <- ggplot2::ggplot(LV, ggplot2::aes(x = time, y = size, group = group, color = group)) +
ggplot2::geom_line()
p
setwd("~/R/MATH550/CW2")
# Import Packages
library(tidyverse)
library(ggplot2)
R_1 <- 30
F_1 <- 40
pred_number_i <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
for (i in 1:t) {
Rt_1 <- Rt + a * Rt - b * Rt * Ft
Ft_1 <- Ft + b * Rt * Ft - g * Ft
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_i <- pred_number_i(103)
print(r_i)
pred_number_ii <- function(t, Rt = R_1, Ft = F_1, a = 0.05, b = 0.0001, g = 0.02, choice = "t") {
set.seed(60854)
for (i in 1:t) {
Rt_1 <- Rt + rbinom(1, Rt, a) - rbinom(1, Rt * Ft, b)
Ft_1 <- Ft + rbinom(1, Rt * Ft, b) - rbinom(1, Ft, g)
Rt <- Rt_1
Ft <- Ft_1
}
if (choice == "r") {
return(Rt)
} else if (choice == "f") {
return(Ft)
} else if (choice == "t") {
return(c(Rt, Ft))
} else {
stop("Str Input Error")
}
}
r_ii <- pred_number_ii(103, R_1, F_1)
print(r_ii)
# Creat DataFrame
t_iii <- seq(1, 1000)
det_rabbits <- sapply(t_iii, pred_number_i, choice = "r")
det_foxes <- sapply(t_iii, pred_number_i, choice = "f")
sto_rabbits <- sapply(t_iii, pred_number_ii, choice = "r")
sto_foxes <- sapply(t_iii, pred_number_ii, choice = "f")
group_iii <- factor(c(rep("det_rabbits", length(t_iii)),
rep("det_foxes", length(t_iii)),
rep("sto_rabbits", length(t_iii)),
rep("sto_foxes", length(t_iii))))
t_rep_iii <- rep(t_iii, 4)
l_iii <- c(det_rabbits, det_foxes, sto_rabbits, sto_foxes)
LV <- data.frame(time = t_rep_iii, size = l_iii, group = group_iii)
# Plot
p <- ggplot2::ggplot(LV, ggplot2::aes(x = time, y = size, group = group, color = group)) +
ggplot2::geom_line()
p
